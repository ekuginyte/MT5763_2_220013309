---
title: "Individual Assignment 2"
author: "Erna Kuginyte, Student Number 220013309"
date: "22/10/2022"
output: html_document
---

### Find the R Markdown file at [the GitHub Repository](https://github.com/ekuginyte/MT5763_2_220013309.git)

## Problem A
### Monte Carlo simulation
#### Initialise

```{r Libraries}
# Include libraries
library(tidyverse)
library(ggplot2)
library(ggpubr)
```

Compute the probability that X > Y , i.e. Pr(X > Y ).

```{r Monte Carlo Simulation}
# Problem A
# Sample size
n <- 10000
# Pre-allocate memory for storing random samples
X <- rep(NA, n)
Y <- rep(NA, n)
prob <- NA
# For reproducibility
set.seed(777)
# Simple Monte Carlo function to calculate probability Pr(X > Y)
# Input:
#  X - samples from normal distribution,
#  Y - samples from uniform distribution.
# Output:
#  prob - probability Pr(X > Y).
my_mc <- function(n) {
  # Generate samples with given boundaries
  X <- rnorm(n, mean = 4, sd = sqrt(10))
  Y <- runif(n, min = 2, max = 8)
  # Check how many x variables are greater than y variables
  # http://ditraglia.com/Econ103Public/Rtutorials/Rtutorial4.html
  prob <- sum(X > Y) / length(X + Y)
  # I wouldn't use return command normally in this place, since the Tidyverse
  # Style Guide advice against it, unless I wanted the return earlier in the 
  # function. However, I have heard this sometimes gets penalised at the 
  # university, hence, the return command at the end of the function.
  return(prob)
}
```

COMMENTS

Use bootstrapping to derive the sampling distribution for the estimate of Pr(X > Y ).

```{r My Bootstrap function}
# Bootstrapping to derive the sampling distribution of Pr(X > Y)
# Sample size
n_repeat <- 1000
# Pre-allocate memory for storing results
boot_res <- rep(NA, n_repeat)
prob_res <- rep(NA, n_repeat)
# For reproducibility
set.seed(555)
# Loop across all samples
# Output:
#  boot_res - store vector of the Pr(X > Y) distribution.
my_bts <- function(n_repeat) {
  for (i in seq(n_repeat)) {
  prob_res[i] <- my_mc(n)
  }
  # Resample with replacement
  boot_res <- sample(x = prob_res, size = n_repeat, replace = TRUE)
  # Store results
  return(boot_res)
}
```







## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
